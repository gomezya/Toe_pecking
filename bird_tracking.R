# required libraries #
library(data.table)
library(dplyr)
library(lubridate)
library("readxl")
library(tidyr)

# get data of specific hen #
setwd("//resstore.unibe.ch/vetsuisse_chicken_run/ToePecking_Amina/Masha/22.10.22-09.12.22_RFID/")
#setwd("//resstore.unibe.ch/vetsuisse_chicken_run/ToePecking_Amina/")
# Loading the data

# Get the list of .csv filenames under a given path
filenames <- list.files(pattern = "\\.csv$", ignore.case=TRUE)

#filename <-filenames
# Load all the files into separate data.table tables
filesData <- lapply(filenames, function(filename) {
  # To have any warnings printed out immediately
  options(warn=1)
  # To correlate warnings with the file
  print(filename)
  
  # Read lines from file
  con <- file(file.path(filename))
  lines <- readLines(con)
  close(con)
  
  # Regular expression pattern
  # Example string: "28.04.2021 16:43:12.66 DA760104 16400088 11"
  pattern <- "^\\d{2}\\.\\d{2}\\.\\d{4} \\d{2}:\\d{2}:\\d{2}(\\.\\d{1,2})? [0-9A-F]{8} \\d{8} \\d{1,2}$"
  #pattern <- "^\\d{2}\\.\\d{2}\\.\\d{4} \\d{2}:\\d{2}:\\d{2} [0-9A-F]{8} \\d{8} \\d{2}$"
  
  # Drop lines that don't match the pattern (as a result of a broken write)
  lines <- lines[grepl(pattern, lines)]
  
  # Glue lines together back into a file + last line break
  text <- paste0(paste0(lines, collapse="\n"), "\n")
  
  # Parse as data.table
  fread(text=text,fill=T)
})


# Merge data in a single data.table
# It can still be unordered
memory.limit(size = 56000)

data <- rbindlist(filesData)


# Free up separate files' data
rm(filesData)

str(data)
head(data)
#View(data)
dim(data)

############## mapping options ##################
henMapping <- c(
  "DA7DAF29" = "16001",
  "DA09BF5A" = "16002",
  "DA09BA48" = "16003",
  "DA760186" = "16004",
  "DA09C120" = "16005",
  "DA7600EB" = "16006",
  "DA09BAA2" = "16007",
  "DA09BFDF" = "16008",
  "DA760160" = "16009",
  "DA76012E" = "16010",
  "DA09BA56" = "16011",
  "DA09C073" = "16012",
  "DA7600CD" = "16013",
  "DA09C1A6" = "16014",
  "DA09BA8C" = "16015",
  "DA09C0D4" = "16016",
  "DA09BE76" = "16017",
  "DA09BFE8" = "16018",
  "DA09B5A0" = "16019",
  "DA760193" = "16020",
  "DA7600EA" = "16021",
  "DA09BFF3" = "16022",
  "DA09BF73" = "16023",
  "DA76019E" = "16024",
  "DA09C129" = "16025",
  "DA09C166" = "16026",
  "DA7600F4" = "16027",
  "DA09BFBF" = "16028",
  "DA760145" = "16029",
  "DA09C19E" = "16030",
  "DA09B780" = "16031",
  "DA76014D" = "16032",
  "DA760172" = "16033",
  "DA09C1A7" = "16034",
  "DA09BA2C" = "16035",
  "DA760131" = "16036",
  "DA09C10D" = "16037",
  "DA7DAF6C" = "16038",
  "DA09C0C8" = "16039",
  "DA7600FD" = "16040",
  "DA09BEFA" = "16041",
  "DA09BACE" = "16042",
  "DA09C0B4" = "16043",
  "DA76017C" = "16044",
  "DA09C0AA" = "16045",
  "DA76012F" = "16046",
  "DA760121" = "16047",
  "DA7600C9" = "16048",
  "DA09BF7E" = "16049",
  "DA09BFEB" = "16050",
  "DA7600B5" = "16051",
  "DA09BEF1" = "16052",
  "DA09BF17" = "16053",
  "DA09C0A2" = "16054",
  "DA760130" = "16055",
  "DA760122" = "16056",
  "DA09BE9C" = "16057",
  "DA09BEBA" = "16058",
  "DA76015D" = "16059",
  "DA09C01D" = "16060",
  "DA09BF85" = "16061",
  "DA09C14E" = "16062",
  "DA760100" = "16063",
  "DA09C0E6" = "16064",
  "DA09C062" = "16065",
  "DA09BFEA" = "16066",
  "DA760143" = "16067",
  "DA09BFC9" = "16068",
  "DA760115" = "16069",
  "DA760115" = "16069",
  "DA76018F" = "16070",
  "DA09C059" = "16071",
  "DA7DAF63" = "16072",
  "DA760196" = "16073",
  "DA09BF5C" = "16074",
  "DA09C0F3" = "16075",
  "DA760167" = "16076",
  "DA7DAF6A" = "16077",
  "DA09BEDF" = "16078",
  "DA7600CA" = "16079",
  "DA09BFFA" = "16080",
  "DA09BF21" = "16081",
  "DA09BEE8" = "16082",
  "DA09BA36" = "16083",
  "DA09BFBE" = "16084",
  "DA09BF4C" = "16085",
  "DA76015F" = "16086",
  "DA09B77B" = "16087",
  "DA76012B" = "16088",
  "DA09C198" = "16089",
  "DA76019D" = "16090",
  "DA7600C6" = "16091",
  "DA76010B" = "16092",
  "DA09C114" = "16093",
  "DA09B759" = "16094",
  "DA7DAF36" = "16095",
  "DA09BF93" = "16096",
  "DA09C140" = "16097",
  "DA09C1AF" = "16098",
  "DA09C12F" = "16099",
  "DA09BE8B" = "16100",
  "DA09BABB" = "16101",
  "DA09C14B" = "16102",
  "DA09C1AE" = "16103",
  "DA760176" = "16104",
  "DA7600E8" = "16105",
  "DA09BAFA" = "16106",
  "DA09C143" = "16107",
  "DA09BABF" = "16108",
  "DA09C0F7" = "16109",
  "DA76010A" = "16110",
  "DA09BAB1" = "16111",
  "DA09B74A" = "16112",
  "DA09BF2B" = "16113",
  "DA09BA1A" = "16114",
  "DA76011B" = "16115",
  "DA09BE93" = "16116",
  "DA09B6D9" = "16117",
  "DA7DAF6B" = "16118",
  "DA09BA96" = "16119",
  "DA09C122" = "16120",
  "DA7DAF52" = "16121",
  "DA09B701" = "16122",
  "DA09C03A" = "16123",
  "DA09B7BD" = "16124",
  "DA7601A3" = "16125",
  "DA7601A3" = "16125",
  "DA760087" = "16126",
  "DA7600F5" = "16127",
  "DA09B730" = "16128",
  "DA09B799" = "16129",
  "DA09BF65" = "16130",
  "DA760092" = "16131",
  "DA760092" = "16131",
  "DA760088" = "16132",
  "DA09C012" = "16133",
  "DA09BA66" = "16134",
  "DA76014C" = "16135",
  "DA09C08B" = "16136",
  "DA09C171" = "16137",
  "DA09BFD9" = "16138",
  "DA7DAF2E" = "16139",
  "DA09B707" = "16140",
  "DA09C1C7" = "16141",
  "DA09C1B3" = "16142",
  "DA09C139" = "16143",
  "DA09BFD8" = "16144",
  "DA09BF97" = "16145",
  "DA7600A8" = "16146",
  "DA09C040" = "16147",
  "DA7DAF40" = "16148",
  "DA09C1A2" = "16149",
  "DA09BEFD" = "16150",
  "DA7DAF68" = "16151",
  "DA09BFE0" = "16152",
  "DA7600E1" = "16153",
  "DA09BED0" = "16154",
  "DA09BF67" = "16155",
  "DA09C05F" = "16156",
  "DA09C16B" = "16157",
  "DA09C0C2" = "16158",
  "DA09BF4D" = "16159",
  "DA7600FC" = "16160",
  "DA09C0E0" = "16161",
  "DA09C1C4" = "16162",
  "DA09C032" = "16163",
  "DA09C13A" = "16164",
  "DA7600F7" = "16165",
  "DA09C0E7" = "16166",
  "DA7DAF47" = "16167",
  "DA760180" = "16168",
  "DA09C12D" = "16169",
  "DA7600D1" = "16170",
  "DA09C176" = "16171",
  "DA09C0B6" = "16172",
  "DA09BF95" = "16173",
  "DA09C0E8" = "16174",
  "DA09BF9B" = "16175",
  "DA09C1B5" = "16176",
  "DA09BAA9" = "16177",
  "DA09C10B" = "16178",
  "DA09BA09" = "16179",
  "DA09BE8D" = "16180",
  "DA09BA33" = "16181",
  "DA09B75F" = "16182",
  "DA09BEAA" = "16183",
  "DA09C185" = "16184",
  "DA09C0B5" = "16185",
  "DA09B6F0" = "16186",
  "DA760185" = "16187",
  "DA09C109" = "16188",
  "DA7600DC" = "16189",
  "DA09BA4E" = "16190",
  "DA09BAE2" = "16191",
  "DA760158" = "16192",
  "DA09BFF9" = "16193",
  "DA09B7F5" = "16194",
  "DA7600E4" = "16195",
  "DA09C15A" = "16196",
  "DA09C1AC" = "16197",
  "DA09C189" = "16198",
  "DA760191" = "16199",
  "DA7600AE" = "16200",
  "DA09C1B0" = "16201",
  "DA7600A5" = "16202",
  "DA09C0FC" = "16203",
  "DA09BACB" = "16204",
  "DA09BA93" = "16205",
  "DA09C102" = "16206",
  "DA09C0A5" = "16207",
  "DA760182" = "16208",
  "DA09BF16" = "16209",
  "DA09C152" = "16210",
  "DA76015B" = "16211",
  "DA09B6D4" = "16212",
  "DA76010E" = "16213",
  "DA76014E" = "16214",
  "DA7DAF57" = "16215",
  "DA7600BF" = "16216",
  "DA09BFCB" = "16217",
  "DA09B7AB" = "16218",
  "DA09C12C" = "16219",
  "DA09BEC1" = "16220",
  "DA7600ED" = "16221",
  "DA76015A" = "16222",
  "DA09B700" = "16223",
  "DA09B7EC" = "16224",
  "DA09BA17" = "16225",
  "DA7DAF4C" = "17001",
  "DA7601AC" = "17002",
  "DA7DAF66" = "17003",
  "DA7DAF38" = "17004",
  "DA09C016" = "17005",
  "DA09BB06" = "17006",
  "DA09B7E5" = "17007",
  "DA09BF1D" = "17008",
  "DA09B7C4" = "17009",
  "DA09BACF" = "17010",
  "DA760134" = "17011",
  "DA7601A1" = "17012",
  "DA09C078" = "17013",
  "DA09BAF8" = "17014",
  "DA09BADD" = "17015",
  "DA7DAF45" = "17016",
  "DA09C11E" = "17017",
  "DA7DAF30" = "17018",
  "DA09C0D1" = "17019",
  "DA09C0CA" = "17020",
  "DA09B7FC" = "17021",
  "DA09C16F" = "17022",
  "DA09B6EE" = "17023",
  "DA09B7D9" = "17024",
  "DA7DAF33" = "17025",
  "DA09BB0C" = "17026",
  "DA760184" = "17027",
  "DA09C18E" = "17028",
  "DA09BA3D" = "17029",
  "DA09B753" = "17030",
  "DA09C03C" = "17031",
  "DA760136" = "17032",
  "DA09C1B4" = "17033",
  "DA09B7FE" = "17034",
  "DA09BA50" = "17035",
  "DA760137" = "17036",
  "DA09C001" = "17037",
  "DA09BA0E" = "17038",
  "DA09BEE9" = "17039",
  "DA09BAD8" = "17040",
  "DA7600BB" = "17041",
  "DA09C10E" = "17042",
  "DA09BE9E" = "17043",
  "DA09BE6F" = "17044",
  "DA09BF01" = "17045",
  "DA76010C" = "17046",
  "DA09C183" = "17047",
  "DA7600D5" = "17048",
  "DA7600B9" = "17049",
  "DA09BA30" = "17050",
  "DA09BEB3" = "17051",
  "DA09C125" = "17052",
  "DA09C125" = "17052",
  "DA09BEFB" = "17053",
  "DA09BEAB" = "17054",
  "DA09B729" = "17055",
  "DA09C113" = "17056",
  "DA760102" = "17057",
  "DA7DAF4F" = "17058",
  "DA09C1C0" = "17059",
  "DA09C157" = "17060",
  "DA09C1CB" = "17061",
  "DA09C161" = "17062",
  "DA09C0AF" = "17063",
  "DA09B7B3" = "17064",
  "DA09C00B" = "17065",
  "DA09C1BC" = "17066",
  "DA09C02A" = "17067",
  "DA760084" = "17068",
  "DA09BA1C" = "17069",
  "DA09C197" = "17070",
  "DA760110" = "17071",
  "DA09C0F5" = "17072",
  "DA7600BA" = "17073",
  "DA09C118" = "17074",
  "DA09BAB0" = "17075",
  "DA09B785" = "17076",
  "DA7601AB" = "17077",
  "DA7600A4" = "17078",
  "DA76018E" = "17079",
  "DA760109" = "17080",
  "DA7600AB" = "17081",
  "DA09BA84" = "17082",
  "DA09BA0F" = "17083",
  "DA09B769" = "17084",
  "DA09BA75" = "17085",
  "DA76013B" = "17086",
  "DA09C1BE" = "17087",
  "DA09C1CA" = "17088",
  "DA09BEC9" = "17089",
  "DA09C156" = "17090",
  "DA09C086" = "17091",
  "DA7600CB" = "17092",
  "DA76009C" = "17093",
  "DA09C1AA" = "17094",
  "DA760123" = "17095",
  "DA7600C4" = "17096",
  "DA09BFB6" = "17097",
  "DA09B7D0" = "17098",
  "DA76008A" = "17099",
  "DA09BE50" = "17100",
  "DA09C028" = "17101",
  "DA09BFF6" = "17102",
  "DA09C17F" = "17103",
  "DA7600B3" = "17104",
  "DA09C1BF" = "17105",
  "DA09B715" = "17106",
  "DA09C0CE" = "17107",
  "DA7DAF6E" = "17108",
  "DA09BEE3" = "17109",
  "DA09C16D" = "17110",
  "DA09C036" = "17111",
  "DA76018D" = "17112",
  "DA09BF92" = "17113",
  "DA09BEB9" = "17114",
  "DA09BF27" = "17115",
  "DA09C06C" = "17116",
  "DA09C0B3" = "17117",
  "DA76008F" = "17118",
  "DA7600F6" = "17119",
  "DA7600CF" = "17120",
  "DA760129" = "17121",
  "DA760103" = "17122",
  "DA09B6E2" = "17123",
  "DA09C1BB" = "17124",
  "DA760189" = "17125",
  "DA09B74B" = "17126",
  "DA09C11D" = "17127",
  "DA09C11D" = "17127",
  "DA7DAF46" = "17128",
  "DA7DAF46" = "17128",
  "DA09C105" = "17129",
  "DA09C18C" = "17130",
  "DA09C0B2" = "17131",
  "DA760199" = "17132",
  "DA7DAF3C" = "17133",
  "DA7600F3" = "17134",
  "DA7600FA" = "17135",
  "DA760154" = "17136",
  "DA09B761" = "17137",
  "DA760098" = "17138",
  "DA09BEE7" = "17139",
  "DA09BA82" = "17140",
  "DA09C167" = "17141",
  "DA09BF35" = "17142",
  "DA09BE91" = "17143",
  "DA09C163" = "17144",
  "DA09BFA7" = "17145",
  "DA7DAF5B" = "17146",
  "DA09BFCA" = "17147",
  "DA09BE51" = "17148",
  "DA09BA4B" = "17149",
  "DA760135" = "17150",
  "DA7DAF2D" = "17151",
  "DA09C1CF" = "17152",
  "DA760128" = "17153",
  "DA09C131" = "17154",
  "DA7DAF37" = "17155",
  "DA76018C" = "17156",
  "DA7600D8" = "17157",
  "DA09BAC8" = "17158",
  "DA09BF4F" = "17159",
  "DA7600C3" = "17160",
  "DA76008E" = "17161",
  "DA09C141" = "17162",
  "DA09C0B0" = "17163",
  "DA760138" = "17164",
  "DA09B7CF" = "17165",
  "DA09BF76" = "17166",
  "DA09BA03" = "17167",
  "DA760190" = "17168",
  "DA09C15B" = "17169",
  "DA09BA55" = "17170",
  "DA09C0B8" = "17171",
  "DA7600F2" = "17172",
  "DA760170" = "17173",
  "DA09C115" = "17174",
  "DA09C093" = "17175",
  "DA09BA81" = "17176",
  "DA09BAEE" = "17177",
  "DA09B722" = "17178",
  "DA760146" = "17179",
  "DA09C060" = "17180",
  "DA09C12A" = "17181",
  "DA09C02F" = "17182",
  "DA09C0DF" = "17183",
  "DA09C135" = "17184",
  "DA760082" = "17185",
  "DA09C127" = "17186",
  "DA7600A2" = "17187",
  "DA760096" = "17188",
  "DA09BED8" = "17189",
  "DA09C1AD" = "17190",
  "DA09BAF2" = "17191",
  "DA09BE5F" = "17192",
  "DA76013A" = "17193",
  "DA7DAF4B" = "17194",
  "DA09BF58" = "17195",
  "DA09C13B" = "17196",
  "DA09C175" = "17197",
  "DA09C0D0" = "17198",
  "DA09C0C1" = "17199",
  "DA7600E0" = "17200",
  "DA09BAED" = "17201",
  "DA7600DA" = "17202",
  "DA09C1B8" = "17203",
  "DA09BFF7" = "17204",
  "DA7601A4" = "17205",
  "DA09B754" = "17206",
  "DA09BAA6" = "17207",
  "DA7600A9" = "17208",
  "DA09BE84" = "17209",
  "DA09BE84" = "17209",
  "DA09BE7E" = "17210",
  "DA09B7A0" = "17211",
  "DA7DAF60" = "17212",
  "DA09C17E" = "17213",
  "DA09C1C6" = "17214",
  "DA09BA25" = "17215",
  "DA09C0B9" = "17216",
  "DA09C05D" = "17217",
  "DA76014F" = "17218",
  "DA09BAEF" = "17219",
  "DA760105" = "17220",
  "DA09C179" = "17221",
  "DA76017A" = "17222",
  "DA09C1C5" = "17223",
  "DA09B7B6" = "17224",
  "DA09BFBD" = "17225",
  "DA09BA43" = "18001",
  "DA2C6370" = "18002",
  "DA09BAE7" = "18003",
  "DA09C1A0" = "18004",
  "DA2C641E" = "18005",
  "DA2C62B3" = "18006",
  "DA09B750" = "18007",
  "DA760094" = "18008",
  "DA7600A6" = "18009",
  "DA09C10F" = "18010",
  "DA09BF74" = "18011",
  "DA2C6489" = "18012",
  "DA7600A7" = "18013",
  "DA09C02C" = "18014",
  "DA760140" = "18015",
  "DA09BFFB" = "18016",
  "DA09B7CB" = "18017",
  "DA09B806" = "18018",
  "DA09C190" = "18019",
  "DA2C63B7" = "18020",
  "DA09BA0A" = "18021",
  "DA2C6474" = "18022",
  "DA2C62A2" = "18023",
  "DA09BA02" = "18024",
  "DA09C1C9" = "18025",
  "DA2C62EF" = "18026",
  "DA2C620B" = "18027",
  "DA2C659C" = "18028",
  "DA2C659C" = "18028",
  "DA7600FB" = "18029",
  "DA09BEF2" = "18030",
  "DA09BF80" = "18031",
  "DA2C6397" = "18032",
  "DA7DAF32" = "18033",
  "DA09B6F4" = "18034",
  "DA2C65ED" = "18035",
  "DA2C6446" = "18036",
  "DA2C65FD" = "18037",
  "DA09BFBA" = "18038",
  "DA09BA49" = "18039",
  "DA09C0F8" = "18040",
  "DA09BB07" = "18041",
  "DA09C0AB" = "18042",
  "DA09C0DB" = "18043",
  "DA09BA05" = "18044",
  "DA2C6483" = "18045",
  "DA2C641C" = "18046",
  "DA09C031" = "18047",
  "DA09BF5D" = "18048",
  "DA09BFE4" = "18049",
  "DA09C0AE" = "18050",
  "DA76008C" = "18051",
  "DA09C154" = "18052",
  "DA09BE80" = "18053",
  "DA2C65A7" = "18054",
  "DA09C13E" = "18055",
  "DA09C130" = "18056",
  "DA09BF03" = "18057",
  "DA2C6334" = "18058",
  "DA09C101" = "18059",
  "DA76010D" = "18060",
  "DA7600E2" = "18061",
  "DA2C6358" = "18062",
  "DA09BA44" = "18063",
  "DA09C106" = "18064",
  "DA09B739" = "18065",
  "DA7600DD" = "18066",
  "DA7DAF3A" = "18067",
  "DA760179" = "18068",
  "DA76011D" = "18069",
  "DA09BF02" = "18070",
  "DA2C6357" = "18071",
  "DA09BF9A" = "18072",
  "DA09BAD9" = "18073",
  "DA2C61D4" = "18074",
  "DA09C10A" = "18075",
  "DA09C0EB" = "18076",
  "DA09B7E0" = "18077",
  "DA09B71A" = "18078",
  "DA09C199" = "18079",
  "DA09C17C" = "18080",
  "DA2C6422" = "18081",
  "DA2C622B" = "18082",
  "DA09C08A" = "18083",
  "DA09C0A7" = "18084",
  "DA09C133" = "18085",
  "DA76019B" = "18086",
  "DA2C6460" = "18087",
  "DA2C635D" = "18088",
  "DA09BA6E" = "18089",
  "DA09BF6A" = "18090",
  "DA09C11B" = "18091",
  "DA09BA0C" = "18092",
  "DA09C065" = "18093",
  "DA760095" = "18094",
  "DA09BEA2" = "18095",
  "DA09B792" = "18096",
  "DA2C64FD" = "18097",
  "DA09BF00" = "18098",
  "DA2C6202" = "18099",
  "DA2C639C" = "18100",
  "DA2C6416" = "18101",
  "DA09BEAD" = "18102",
  "DA09C0BD" = "18103",
  "DA09BAF9" = "18104",
  "DA2C61EF" = "18105",
  "DA2C658D" = "18106",
  "DA09C136" = "18107",
  "DA09C09C" = "18108",
  "DA760174" = "18109",
  "DA09B775" = "18110",
  "DA09C191" = "18111",
  "DA2C64B4" = "18112",
  "DA09C153" = "18113",
  "DA09BEDD" = "18114",
  "DA09C147" = "18115",
  "DA2C65C1" = "18116",
  "DA09BEE4" = "18117",
  "DA09BFA4" = "18118",
  "DA09BFA4" = "18118",
  "DA09C16C" = "18119",
  "DA09BAE8" = "18120",
  "DA09C0C0" = "18121",
  "DA09BFAD" = "18122",
  "DA09B7C3" = "18123",
  "DA2C6448" = "18124",
  "DA09C0F2" = "18125",
  "DA09B7D8" = "18126",
  "DA2C6190" = "18127",
  "DA7DAF70" = "18128",
  "DA2C633C" = "18129",
  "DA2C6453" = "18130",
  "DA09BEA7" = "18131",
  "DA09BE81" = "18132",
  "DA09BB05" = "18133",
  "DA2C635A" = "18134",
  "DA760171" = "18135",
  "DA09C11C" = "18136",
  "DA09C1C8" = "18137",
  "DA09BFA0" = "18138",
  "DA09C0D9" = "18139",
  "DA09C098" = "18140",
  "DA2C617D" = "18141",
  "DA2C630F" = "18142",
  "DA09C1C3" = "18143",
  "DA2C64A3" = "18144",
  "DA09C187" = "18145",
  "DA09BA7D" = "18146",
  "DA76011C" = "18147",
  "DA09C0BE" = "18148",
  "DA2C6340" = "18149",
  "DA09BF2A" = "18150",
  "DA09C0CB" = "18151",
  "DA09BAE9" = "18152",
  "DA09C0ED" = "18153",
  "DA2C634E" = "18154",
  "DA09C013" = "18155",
  "DA2C654B" = "18156",
  "DA2C6546" = "18157",
  "DA2C61C1" = "18158",
  "DA09C03F" = "18159",
  "DA09C0C9" = "18160",
  "DA09BA6D" = "18161",
  "DA2C63D2" = "18162",
  "DA2C62FD" = "18163",
  "DA09BFEE" = "18164",
  "DA2C6149" = "18165",
  "DA09C1BD" = "18166",
  "DA09C0EA" = "18167",
  "DA2C61D9" = "18168",
  "DA09C14A" = "18169",
  "DA09BA51" = "18170",
  "DA09C112" = "18171",
  "DA76016C" = "18172",
  "DA09C181" = "18173",
  "DA2C65B3" = "18174",
  "DA09BFD2" = "18175",
  "DA2C65F8" = "18176",
  "DA7600E5" = "18177",
  "DA09B75D" = "18178",
  "DA2C63C2" = "18179",
  "DA09C110" = "18180",
  "DA09C110" = "18180",
  "DA09C169" = "18181",
  "DA09BFA1" = "18182",
  "DA2C6496" = "18183",
  "DA2C62F6" = "18184",
  "DA09C19D" = "18185",
  "DA09C0AD" = "18186",
  "DA09BFFD" = "18187",
  "DA09B74E" = "18188",
  "DA09C0EF" = "18189",
  "DA09BF1F" = "18190",
  "DA2C634A" = "18191",
  "DA09C177" = "18192",
  "DA09C029" = "18193",
  "DA2C65BE" = "18194",
  "DA09C146" = "18195",
  "DA2C646A" = "18196",
  "DA7601A5" = "18197",
  "DA09C178" = "18198",
  "DA09C008" = "18199",
  "DA2C61E9" = "18200",
  "DA09C0B1" = "18201",
  "DA2C658C" = "18202",
  "DA09C17A" = "18203",
  "DA09BF41" = "18204",
  "DA2C65D2" = "18205",
  "DA09C13C" = "18206",
  "DA09BFED" = "18207",
  "DA2C6405" = "18208",
  "DA09B5E5" = "18209",
  "DA09C092" = "18210",
  "DA2C61DA" = "18211",
  "DA09BF77" = "18212",
  "DA09BF77" = "18212",
  "DA2C6436" = "18213",
  "DA09BEFE" = "18214",
  "DA2C635F" = "18215",
  "DA09C107" = "18216",
  "DA2C64A7" = "18217",
  "DA09BFFF" = "18218",
  "DA09C030" = "18219",
  "DA760090" = "18220",
  "DA09B6C7" = "18221",
  "DA09B6C7" = "18221",
  "DA2C653C" = "18222",
  "DA2C6596" = "18223",
  "DA2C6381" = "18224",
  "DA2C627F" = "18225",
  "DA2C641D" = "19001",
  "DA09C15E" = "19002",
  "DA2C632F" = "19003",
  "DA09B76C" = "19004",
  "DA09B79A" = "19005",
  "DA2C65D7" = "19006",
  "DA09BFE6" = "19007",
  "DA2C6383" = "19008",
  "DA7600FE" = "19009",
  "DA09B6D8" = "19010",
  "DA09BF70" = "19011",
  "DA09C18D" = "19012",
  "DA2C629F" = "19013",
  "DA09BE8F" = "19014",
  "DA09BEB4" = "19015",
  "DA09B77E" = "19016",
  "DA09B7FA" = "19017",
  "DA2C659B" = "19018",
  "DA09C0D8" = "19019",
  "DA09BB04" = "19020",
  "DA2C618E" = "19021",
  "DA09C12E" = "19022",
  "DA2C6470" = "19023",
  "DA2C63D1" = "19024",
  "DA09C16A" = "19025",
  "DA2C6275" = "19026",
  "DA09BE6D" = "19027",
  "DA09C021" = "19028",
  "DA09BE73" = "19029",
  "DA2C6402" = "19030",
  "DA09B75B" = "19031",
  "DA09B7A9" = "19032",
  "DA2C630B" = "19033",
  "DA09C05E" = "19034",
  "DA2C635B" = "19035",
  "DA2C62CB" = "19036",
  "DA2C640B" = "19037",
  "DA09B709" = "19038",
  "DA2C6466" = "19039",
  "DA09BFF8" = "19040",
  "DA2C6254" = "19041",
  "DA09BF1C" = "19042",
  "DA2C62A8" = "19043",
  "DA2C654D" = "19044",
  "DA2C645D" = "19045",
  "DA2C645A" = "19046",
  "DA09C0FB" = "19047",
  "DA09BE25" = "19048",
  "DA09C0A8" = "19049",
  "DA09C119" = "19050",
  "DA2C63C3" = "19051",
  "DA09C02D" = "19052",
  "DA2C64D7" = "19053",
  "DA2C6375" = "19054",
  "DA09C1BA" = "19055",
  "DA09BF36" = "19056",
  "DA09BA4D" = "19057",
  "DA2C655D" = "19058",
  "DA2C6300" = "19059",
  "DA2C6219" = "19060",
  "DA2C64E6" = "19061",
  "DA09C111" = "19062",
  "DA09BA2B" = "19063",
  "DA2C6317" = "19064",
  "DA09BA8B" = "19065",
  "DA2C63B2" = "19066",
  "DA2C65D8" = "19067",
  "DA09C14C" = "19068",
  "DA2C63AB" = "19069",
  "DA09C0C4" = "19070",
  "DA09BE5A" = "19071",
  "DA76013F" = "19072",
  "DA09C17D" = "19073",
  "DA09BA2A" = "19074",
  "DA09C1C1" = "19075",
  "DA760151" = "19076",
  "DA2C65CD" = "19077",
  "DA09BAC1" = "19078",
  "DA760097" = "19079",
  "DA7600BD" = "19080",
  "DA09BF56" = "19081",
  "DA09C13D" = "19082",
  "DA09C132" = "19083",
  "DA2C62D5" = "19084",
  "DA09C144" = "19085",
  "DA7DAF69" = "19086",
  "DA09BF2D" = "19087",
  "DA09C0CD" = "19088",
  "DA2C63EF" = "19089",
  "DA2C6522" = "19090",
  "DA09C0F4" = "19091",
  "DA2C65BA" = "19092",
  "DA7DAF2B" = "19093",
  "DA2C633B" = "19094",
  "DA2C6304" = "19095",
  "DA09B70C" = "19096",
  "DA09B78E" = "19097",
  "DA7DAF3B" = "19098",
  "DA2C6521" = "19099",
  "DA09C0FE" = "19100",
  "DA09B6FC" = "19101",
  "DA09C168" = "19102",
  "DA2C62E3" = "19103",
  "DA09C100" = "19104",
  "DA09BAD4" = "19105",
  "DA09C080" = "19106",
  "DA2C63C4" = "19107",
  "DA7600B1" = "19108",
  "DA2C64BE" = "19109",
  "DA09C1A5" = "19110",
  "DA2C6255" = "19111",
  "DA09C160" = "19112",
  "DA09C057" = "19113",
  "DA2C65C0" = "19114",
  "DA2C63D6" = "19115",
  "DA2C640E" = "19116",
  "DA2C6577" = "19117",
  "DA09BF8F" = "19118",
  "DA2C650E" = "19119",
  "DA2C6492" = "19120",
  "DA760194" = "19121",
  "DA2C6433" = "19122",
  "DA2C624C" = "19123",
  "DA2C6456" = "19124",
  "DA760120" = "19125",
  "DA2C6366" = "19126",
  "DA7600D7" = "19127",
  "DA2C6475" = "19128",
  "DA2C6250" = "19129",
  "DA2C616A" = "19130",
  "DA09B803" = "19131",
  "DA2C645C" = "19132",
  "DA2C6523" = "19133",
  "DA2C62CD" = "19134",
  "DA09B7AD" = "19135",
  "DA09C0DC" = "19136",
  "DA7600EC" = "19137",
  "DA2C62AF" = "19138",
  "DA09C180" = "19139",
  "DA09BEF7" = "19140",
  "DA2C631A" = "19141",
  "DA09C172" = "19142",
  "DA2C63E8" = "19143",
  "DA09BFB7" = "19144",
  "DA2C65AF" = "19145",
  "DA2C64AA" = "19146",
  "DA09C0C5" = "19147",
  "DA2C65F3" = "19148",
  "DA09BA7B" = "19149",
  "DA09C1A1" = "19150",
  "DA09C158" = "19151",
  "DA2C64A1" = "19152",
  "DA2C6477" = "19153",
  "DA2C63CA" = "19154",
  "DA2C6392" = "19155",
  "DA2C641F" = "19156",
  "DA09BE9D" = "19157",
  "DA09C0E3" = "19158",
  "DA09C1B6" = "19159",
  "DA76011E" = "19160",
  "DA09BA7C" = "19161",
  "DA09C19A" = "19162",
  "DA2C6429" = "19163",
  "DA2C65FC" = "19164",
  "DA2C62BD" = "19165",
  "DA2C6376" = "19166",
  "DA09BE7F" = "19167",
  "DA2C6443" = "19168",
  "DA09C159" = "19169",
  "DA09C04B" = "19170",
  "DA09C0D2" = "19171",
  "DA09C0CC" = "19172",
  "DA2C6261" = "19173",
  "DA09C0BF" = "19174",
  "DA09BA78" = "19175",
  "DA09BEC0" = "19176",
  "DA09C0D6" = "19177",
  "DA09C108" = "19178",
  "DA2C6362" = "19179",
  "DA09B793" = "19180",
  "DA09C138" = "19181",
  "DA2C63EB" = "19182",
  "DA2C6378" = "19183",
  "DA09BFB5" = "19184",
  "DA09C026" = "19185",
  "DA09BEDA" = "19186",
  "DA760083" = "19187",
  "DA09C1A8" = "19188",
  "DA2C6222" = "19189",
  "DA09C1A4" = "19190",
  "DA09C137" = "19191",
  "DA2C638B" = "19192",
  "DA09C188" = "19193",
  "DA09B7E3" = "19194",
  "DA09BFA8" = "19195",
  "DA760133" = "19196",
  "DA2C655F" = "19197",
  "DA2C6533" = "19198",
  "DA09BA35" = "19199",
  "DA09BF05" = "19200",
  "DA09BECD" = "19201",
  "DA09C151" = "19202",
  "DA09C1C2" = "19203",
  "DA2C6493" = "19204",
  "DA760156" = "19205",
  "DA09B7FB" = "19206",
  "DA09BFD1" = "19207",
  "DA09C165" = "19208",
  "DA09C148" = "19209",
  "DA09BA59" = "19210",
  "DA09C17B" = "19211",
  "DA09BA29" = "19212",
  "DA2C6525" = "19213",
  "DA09C193" = "19214",
  "DA09C0E9" = "19215",
  "DA09C19F" = "19216",
  "DA09BE94" = "19217",
  "DA7600D2" = "19218",
  "DA09BE67" = "19219",
  "DA2C6516" = "19220",
  "DA2C6415" = "19221",
  "DA09BFF5" = "19222",
  "DA76012C" = "19223",
  "DA2C637D" = "19224",
  "DA09C11A" = "19225",
  "DA7DAF35" = "20001",
  "DA09C196" = "20002",
  "DA09C126" = "20003",
  "DA7600D4" = "20004",
  "DA09C162" = "20005",
  "DA09C0B7" = "20006",
  "DA09C18A" = "20007",
  "DA09C0EE" = "20008",
  "DA2C6283" = "20009",
  "DA2C64CD" = "20010",
  "DA09C0D3" = "20011",
  "DA09C0DD" = "20012",
  "DA2C6558" = "20013",
  "DA09B744" = "20014",
  "DA2C6441" = "20015",
  "DA2C649B" = "20016",
  "DA2C652B" = "20017",
  "DA760091" = "20018",
  "DA2C646F" = "20019",
  "DA09C0F1" = "20020",
  "DA09C082" = "20021",
  "DA2C65EE" = "20022",
  "DA09B7D6" = "20023",
  "DA09B763" = "20024",
  "DA09C19B" = "20025",
  "DA09B717" = "20026",
  "DA09C0BC" = "20027",
  "DA09C0F0" = "20028",
  "DA2C6568" = "20029",
  "DA09C192" = "20030",
  "DA09C1A3" = "20031",
  "DA09C0C7" = "20032",
  "DA2C62E8" = "20033",
  "DA2C614A" = "20034",
  "DA09B6F7" = "20035",
  "DA2C6352" = "20036",
  "DA760085" = "20037",
  "DA09C15F" = "20038",
  "DA09C044" = "20039",
  "DA09C186" = "20040",
  "DA2C62BF" = "20041",
  "DA7DAF43" = "20042",
  "DA2C6280" = "20043",
  "DA2C654A" = "20044",
  "DA09BF09" = "20045",
  "DA09C150" = "20046",
  "DA09C103" = "20047",
  "DA09C124" = "20048",
  "DA09BED9" = "20049",
  "DA09C053" = "20050",
  "DA09C1B2" = "20051",
  "DA09B747" = "20052",
  "DA09BED3" = "20053",
  "DA2C643F" = "20054",
  "DA2C6341" = "20055",
  "DA09BA8A" = "20056",
  "DA09BA08" = "20057",
  "DA09C0E2" = "20058",
  "DA09C12B" = "20059",
  "DA09C005" = "20060",
  "DA09C0A6" = "20061",
  "DA09C0D5" = "20062",
  "DA2C63EC" = "20063",
  "DA09C0A1" = "20064",
  "DA760195" = "20065",
  "DA09BE97" = "20066",
  "DA09C0FA" = "20067",
  "DA2C6432" = "20068",
  "DA7601AA" = "20069",
  "DA7601AA" = "20069",
  "DA09BE68" = "20070",
  "DA09C174" = "20071",
  "DA09C0D7" = "20072",
  "DA2C62BB" = "20073",
  "DA09C1AB" = "20074",
  "DA09BF0F" = "20075",
  "DA09B6DB" = "20076",
  "DA09BAB8" = "20077",
  "DA2C62C4" = "20078",
  "DA09BE89" = "20079",
  "DA2C645F" = "20080",
  "DA09B791" = "20081",
  "DA76014A" = "20082",
  "DA2C649D" = "20083",
  "DA09B7CD" = "20084",
  "DA09BB0B" = "20085",
  "DA2C650D" = "20086",
  "DA2C6578" = "20087",
  "DA09BFF0" = "20088",
  "DA09BAA4" = "20089",
  "DA09BAB9" = "20090",
  "DA760155" = "20091",
  "DA09C117" = "20092",
  "DA09C11F" = "20093",
  "DA2C62FF" = "20094",
  "DA2C62F1" = "20095",
  "DA2C61AD" = "20096",
  "DA2C62B4" = "20097",
  "DA2C61A5" = "20098",
  "DA2C61CA" = "20099",
  "DA2C6355" = "20100",
  "DA2C6232" = "20101",
  "DA2C6238" = "20102",
  "DA2C62D3" = "20103",
  "DA2C6155" = "20104",
  "DA2C6153" = "20105",
  "DA2C62DE" = "20106",
  "DA2C64CB" = "20107",
  "DA2C618F" = "20108",
  "DA2C62F0" = "20109",
  "DA2C65A0" = "20110",
  "DA2C6253" = "20111",
  "DA2C6266" = "20112",
  "DA2C652A" = "20113",
  "DA2C65DA" = "20114",
  "DA2C6152" = "20115",
  "DA2C6152" = "20115",
  "DA2C64E1" = "20116",
  "DA2C6233" = "20117",
  "DA2C6345" = "20118",
  "DA2C6236" = "20119",
  "DA2C6274" = "20120",
  "DA2C6184" = "20121",
  "DA2C6388" = "20122",
  "DA2C625B" = "20123",
  "DA2C61E0" = "20124",
  "DA2C6210" = "20125",
  "DA2C62D7" = "20126",
  "DA2C65FB" = "20127",
  "DA2C64BA" = "20128",
  "DA2C637A" = "20129",
  "DA2C63F7" = "20130",
  "DA2C62C5" = "20131",
  "DA2C61B3" = "20132",
  "DA2C6256" = "20133",
  "DA2C62AD" = "20134",
  "DA2C63C5" = "20135",
  "DA2C6156" = "20136",
  "DA2C6240" = "20137",
  "DA2C626A" = "20138",
  "DA2C6574" = "20139",
  "DA2C62DC" = "20140",
  "DA2C6414" = "20141",
  "DA2C6413" = "20142",
  "DA2C62CF" = "20143",
  "DA2C6179" = "20144",
  "DA2C644E" = "20145",
  "DA2C61DF" = "20146",
  "DA2C61D6" = "20147",
  "DA2C629D" = "20148",
  "DA2C622A" = "20149",
  "DA2C6313" = "20150",
  "DA2C61E2" = "20151",
  "DA2C63E4" = "20152",
  "DA2C6185" = "20153",
  "DA2C651C" = "20154",
  "DA2C62B6" = "20155",
  "DA2C619A" = "20156",
  "DA2C65F1" = "20157",
  "DA2C64E8" = "20158",
  "DA2C652E" = "20159",
  "DA2C6373" = "20160",
  "DA2C6164" = "20161",
  "DA2C6442" = "20162",
  "DA2C61ED" = "20163",
  "DA2C63B6" = "20164",
  "DA2C63CC" = "20165",
  "DA2C623A" = "20166",
  "DA2C63AF" = "20167",
  "DA2C63D8" = "20168",
  "DA2C625C" = "20169",
  "DA2C6175" = "20170",
  "DA2C64EC" = "20171",
  "DA2C62E1" = "20172",
  "DA2C6241" = "20173",
  "DA2C627A" = "20174",
  "DA2C61BD" = "20175",
  "DA2C63BF" = "20176",
  "DA2C61AE" = "20177",
  "DA2C65DB" = "20178",
  "DA2C6463" = "20179",
  "DA2C6321" = "20180",
  "DA2C6201" = "20181",
  "DA2C61A7" = "20182",
  "DA2C62E5" = "20183",
  "DA2C63F8" = "20184",
  "DA2C6338" = "20185",
  "DA2C61DC" = "20186",
  "DA2C61EB" = "20187",
  "DA2C63FF" = "20188",
  "DA2C6258" = "20189",
  "DA2C632E" = "20190",
  "DA2C6163" = "20191",
  "DA2C6151" = "20192",
  "DA2C6328" = "20193",
  "DA2C61F6" = "20194",
  "DA2C650F" = "20195",
  "DA2C642C" = "20196",
  "DA2C6377" = "20197",
  "DA2C6323" = "20198",
  "DA2C6257" = "20199",
  "DA2C63AE" = "20200",
  "DA2C6216" = "20201",
  "DA2C65B1" = "20202",
  "DA2C6538" = "20203",
  "DA2C617B" = "20204",
  "DA2C6346" = "20205",
  "DA2C6384" = "20206",
  "DA2C6171" = "20207",
  "DA2C65A8" = "20208",
  "DA2C63AC" = "20209",
  "DA2C62B2" = "20210",
  "DA2C61F2" = "20211",
  "DA2C6389" = "20212",
  "DA2C62CA" = "20213",
  "DA2C648C" = "20214",
  "DA2C6218" = "20215",
  "DA2C6268" = "20216",
  "DA2C62E9" = "20217",
  "DA2C61F5" = "20218",
  "DA2C6550" = "20219",
  "DA2C61AC" = "20220",
  "DA2C62EE" = "20221",
  "DA2C624D" = "20222",
  "DA2C6541" = "20223",
  "DA2C61AB" = "20224",
  "DA2C62BC" = "20225"
)
zoneMapping <- c(
  "16401687" = "16.1",
  "16401672" = "16.2",
  "16401673" = "16.3",
  "16401675" = "16.4",
  "16401676" = "16.5",
  "16401689" = "16.6",
  "16401683" = "16.7",
  "16401678" = "16.8",
  "16401682" = "16.9",
  "16401688" = "16.10",
  "16401677" = "16.11",
  "16401685" = "16.12",
  "16401681" = "16.13",
  "16401674" = "16.14",
  "16401690" = "16.15",
  "16401680" = "16.16",
  "16401628" = "16.17",
  "16401621" = "16.18",
  "16400088" = "16.19",
  "16401629" = "16.20",
  "16401679" = "16.21",
  "16400016" = "16.22",
  "16401630" = "16.23",
  "16401686" = "16.24",
  "16401622" = "16.25",
  "16401625" = "16.26",
  "16401623" = "16.27",
  "16401671" = "16.28",
  "16401626" = "16.29",
  "16401624" = "16.30",
  "16401684" = "16.31",
  "16401627" = "16.32",
  "16400079" = "17.1",
  "16400013" = "17.2",
  "16400068" = "17.3",
  "16400050" = "17.4",
  "16400164" = "17.5",
  "20400267" = "17.6",
  "16400099" = "17.7",
  "20400284" = "17.8",
  "16400094" = "17.9",
  "16400059" = "17.10",
  "16400092" = "17.11",
  "16400069" = "17.12",
  "16400086" = "17.13",
  "16400058" = "17.14",
  "16400010" = "17.15",
  "16400048" = "17.16",
  "16400041" = "17.17",
  "16400007" = "17.18",
  "16400004" = "17.19",
  "16400029" = "17.20",
  "16400024" = "17.21",
  "16400096" = "17.22",
  "16400012" = "17.23",
  "16400034" = "17.24",
  "20400248" = "17.25",
  "20400289" = "17.26",
  "16400032" = "17.27",
  "20400540" = "17.28",
  "16400095" = "17.29",
  "16400054" = "17.30",
  "16400019" = "17.31",
  "16400018" = "17.32",
  "16400031" = "18.1",
  "16400057" = "18.2",
  "20400287" = "18.3",
  "20400293" = "18.4",
  "20400243" = "18.5",
  "16400162" = "18.6",
  "16400087" = "18.7",
  "16400006" = "18.8",
  "16400053" = "18.9",
  "16400033" = "18.10",
  "16400065" = "18.11",
  "20400247" = "18.12",
  "16400163" = "18.13",
  "16400064" = "18.14",
  "20400283" = "18.15",
  "16400082" = "18.16",
  "16400083" = "18.17",
  "16400075" = "18.18",
  "16400077" = "18.19",
  "16400049" = "18.20",
  "16400022" = "18.21",
  "16400081" = "18.22",
  "16400043" = "18.23",
  "16400084" = "18.24",
  "16400023" = "18.25",
  "16400066" = "18.26",
  "16400021" = "18.27",
  "16400080" = "18.28",
  "20400249" = "18.29",
  "16400089" = "18.30",
  "16400020" = "18.31",
  "16400009" = "18.32",
  "16400046" = "19.1",
  "16400008" = "19.2",
  "20400552" = "19.3",
  "16400002" = "19.4",
  "20400242" = "19.5",
  "20400530" = "19.6",
  "16400097" = "19.7",
  "16400090" = "19.8",
  "16400072" = "19.9",
  "20400240" = "19.10",
  "16400037" = "19.11",
  "20400266" = "19.12",
  "16400076" = "19.13",
  "16400017" = "19.14",
  "20400241" = "19.15",
  "20400288" = "19.16",
  "16400093" = "19.17",
  "16400067" = "19.18",
  "20400246" = "19.19",
  "16400047" = "19.20",
  "16400025" = "19.21",
  "16400014" = "19.22",
  "16400070" = "19.23",
  "16400001" = "19.24",
  "16400085" = "19.25",
  "16400071" = "19.26",
  "16400060" = "19.27",
  "16400028" = "19.28",
  "16400035" = "19.29",
  "16400039" = "19.30",
  "16400003" = "19.31",
  "16400038" = "19.32",
  "16400074" = "20.1",
  "16400030" = "20.2",
  "20400292" = "20.3",
  "16400015" = "20.4",
  "16400005" = "20.5",
  "16400045" = "20.6",
  "16400061" = "20.7",
  "16400091" = "20.8",
  "20400281" = "20.9",
  "20400295" = "20.10",
  "16400026" = "20.11",
  "20400268" = "20.12",
  "16400040" = "20.13",
  "16400051" = "20.14",
  "16400052" = "20.15",
  "16400062" = "20.16",
  "16400027" = "20.17",
  "20400244" = "20.18",
  "20400290" = "20.19",
  "20400541" = "20.20",
  "16400098" = "20.21",
  "16400044" = "20.22",
  "16400078" = "20.23",
  "16400011" = "20.24",
  "16400042" = "20.25",
  "16400056" = "20.26",
  "16400073" = "20.27",
  "16400055" = "20.28",
  "16400063" = "20.29",
  "16400161" = "20.30",
  "16400100" = "20.31",
  "16400036" = "20.32"
)



sideMapping <- c(
  "16.1"  = "AKB",
  "16.2"  = "AKB",
  "16.3"  = "AKB",
  "16.4"  = "Eingang",
  "16.5"  = "Eingang",
  "16.6"  = "Eingang",
  "16.7"  = "AKB",
  "16.8"  = "AKB",
  "16.9"  = "AKB",
  "16.10" = "Eingang",
  "16.11" = "Eingang",
  "16.12" = "Eingang",
  "16.13" = "AKB",
  "16.14" = "AKB",
  "16.15" = "AKB",
  "16.16" = "Eingang",
  "16.17" = "Eingang",
  "16.18" = "Eingang",
  "16.19" = "AKB",
  "16.20" = "AKB",
  "16.21" = "AKB",
  "16.22" = "Eingang",
  "16.23" = "Eingang",
  "16.24" = "Eingang",
  "16.25" = "Eingang",
  "16.26" = "Eingang",
  "16.27" = "Eingang",
  "16.28" = "AKB",
  "16.29" = "AKB",
  "16.30" = "AKB",
  "16.31" = "PH",
  "16.32" = "WG",
  "17.1"  = "AKB",
  "17.2"  = "AKB",
  "17.3"  = "AKB",
  "17.4"  = "Eingang",
  "17.5"  = "Eingang",
  "17.6"  = "Eingang",
  "17.7"  = "AKB",
  "17.8"  = "AKB",
  "17.9"  = "AKB",
  "17.10" = "Eingang",
  "17.11" = "Eingang",
  "17.12" = "Eingang",
  "17.13" = "AKB",
  "17.14" = "AKB",
  "17.15" = "AKB",
  "17.16" = "Eingang",
  "17.17" = "Eingang",
  "17.18" = "Eingang",
  "17.19" = "AKB",
  "17.20" = "AKB",
  "17.21" = "AKB",
  "17.22" = "Eingang",
  "17.23" = "Eingang",
  "17.24" = "Eingang",
  "17.25" = "Eingang",
  "17.26" = "Eingang",
  "17.27" = "Eingang",
  "17.28" = "AKB",
  "17.29" = "AKB",
  "17.30" = "AKB",
  "17.31" = "PH",
  "17.32" = "WG",
  "18.1"  = "AKB",
  "18.2"  = "AKB",
  "18.3"  = "AKB",
  "18.4"  = "Eingang",
  "18.5"  = "Eingang",
  "18.6"  = "Eingang",
  "18.7"  = "AKB",
  "18.8"  = "AKB",
  "18.9"  = "AKB",
  "18.10" = "Eingang",
  "18.11" = "Eingang",
  "18.12" = "Eingang",
  "18.13" = "AKB",
  "18.14" = "AKB",
  "18.15" = "AKB",
  "18.16" = "Eingang",
  "18.17" = "Eingang",
  "18.18" = "Eingang",
  "18.19" = "AKB",
  "18.20" = "AKB",
  "18.21" = "AKB",
  "18.22" = "Eingang",
  "18.23" = "Eingang",
  "18.24" = "Eingang",
  "18.25" = "Eingang",
  "18.26" = "Eingang",
  "18.27" = "Eingang",
  "18.28" = "AKB",
  "18.29" = "AKB",
  "18.30" = "AKB",
  "18.31" = "PH",
  "18.32" = "WG",
  "19.1"  = "AKB",
  "19.2"  = "AKB",
  "19.3"  = "AKB",
  "19.4"  = "Eingang",
  "19.5"  = "Eingang",
  "19.6"  = "Eingang",
  "19.7"  = "AKB",
  "19.8"  = "AKB",
  "19.9"  = "AKB",
  "19.10" = "Eingang",
  "19.11" = "Eingang",
  "19.12" = "Eingang",
  "19.13" = "AKB",
  "19.14" = "AKB",
  "19.15" = "AKB",
  "19.16" = "Eingang",
  "19.17" = "Eingang",
  "19.18" = "Eingang",
  "19.19" = "AKB",
  "19.20" = "AKB",
  "19.21" = "AKB",
  "19.22" = "Eingang",
  "19.23" = "Eingang",
  "19.24" = "Eingang",
  "19.25" = "Eingang",
  "19.26" = "Eingang",
  "19.27" = "Eingang",
  "19.28" = "AKB",
  "19.29" = "AKB",
  "19.30" = "AKB",
  "19.31" = "PH",
  "19.32" = "WG",
  "20.1"  = "AKB",
  "20.2"  = "AKB",
  "20.3"  = "AKB",
  "20.4"  = "Eingang",
  "20.5"  = "Eingang",
  "20.6"  = "Eingang",
  "20.7"  = "AKB",
  "20.8"  = "AKB",
  "20.9"  = "AKB",
  "20.10" = "Eingang",
  "20.11" = "Eingang",
  "20.12" = "Eingang",
  "20.13" = "AKB",
  "20.14" = "AKB",
  "20.15" = "AKB",
  "20.16" = "Eingang",
  "20.17" = "Eingang",
  "20.18" = "Eingang",
  "20.19" = "AKB",
  "20.20" = "AKB",
  "20.21" = "AKB",
  "20.22" = "Eingang",
  "20.23" = "Eingang",
  "20.24" = "Eingang",
  "20.25" = "Eingang",
  "20.26" = "Eingang",
  "20.27" = "Eingang",
  "20.28" = "AKB",
  "20.29" = "AKB",
  "20.30" = "AKB",
  "20.31" = "PH",
  "20.32" =  "WG"
)
###directly to tier instead of antenna###
tierMapping <- c(
  "16401687" = "5",
  "16401672" = "5",
  "16401673" = "5",
  "16401675" = "5",
  "16401676" = "5",
  "16401689" = "5",
  "16401683" = "4",
  "16401678" = "4",
  "16401682" = "4",
  "16401688" = "4",
  "16401677" = "4",
  "16401685" = "4",
  "16401681" = "3",
  "16401674" = "3",
  "16401690" = "3",
  "16401680" = "3",
  "16401628" = "3",
  "16401621" = "3",
  "16400088" = "2",
  "16401629" = "2",
  "16401679" = "2",
  "16400016" = "2",
  "16401630" = "2",
  "16401686" = "2",
  "16401622" = "2",
  "16401625" = "2",
  "16401623" = "2",
  "16401671" = "2",
  "16401626" = "2",
  "16401624" = "2",
  "16401684" = "2",
  "16401627" = "1",
  "16400079" = "5",
  "16400013" = "5",
  "16400068" = "5",
  "16400050" = "5",
  "16400164" = "5",
  "20400267" = "5",
  "16400099" = "4",
  "20400284" = "4",
  "16400094" = "4",
  "16400059" = "4",
  "16400092" = "4",
  "16400069" = "4",
  "16400086" = "3",
  "16400058" = "3",
  "16400010" = "3",
  "16400048" = "3",
  "16400041" = "3",
  "16400007" = "3",
  "16400004" = "2",
  "16400029" = "2",
  "16400024" = "2",
  "16400096" = "2",
  "16400012" = "2",
  "16400034" = "2",
  "20400248" = "2",
  "20400289" = "2",
  "16400032" = "2",
  "20400540" = "2",
  "16400095" = "2",
  "16400054" = "2",
  "16400019" = "2",
  "16400018" = "1",
  "16400031" = "5",
  "16400057" = "5",
  "20400287" = "5",
  "20400293" = "5",
  "20400243" = "5",
  "16400162" = "5",
  "16400087" = "4",
  "16400006" = "4",
  "16400053" = "4",
  "16400033" = "4",
  "16400065" = "4",
  "20400247" = "4",
  "16400163" = "3",
  "16400064" = "3",
  "20400283" = "3",
  "16400082" = "3",
  "16400083" = "3",
  "16400075" = "3",
  "16400077" = "2",
  "16400049" = "2",
  "16400022" = "2",
  "16400081" = "2",
  "16400043" = "2",
  "16400084" = "2",
  "16400023" = "2",
  "16400066" = "2",
  "16400021" = "2",
  "16400080" = "2",
  "20400249" = "2",
  "16400089" = "2",
  "16400020" = "2",
  "16400009" = "1",
  "16400046" = "5",
  "16400008" = "5",
  "20400552" = "5",
  "16400002" = "5",
  "20400242" = "5",
  "20400530" = "5",
  "16400097" = "4",
  "16400090" = "4",
  "16400072" = "4",
  "20400240" = "4",
  "16400037" = "4",
  "20400266" = "4",
  "16400076" = "3",
  "16400017" = "3",
  "20400241" = "3",
  "20400288" = "3",
  "16400093" = "3",
  "16400067" = "3",
  "20400246" = "2",
  "16400047" = "2",
  "16400025" = "2",
  "16400014" = "2",
  "16400070" = "2",
  "16400001" = "2",
  "16400085" = "2",
  "16400071" = "2",
  "16400060" = "2",
  "16400028" = "2",
  "16400035" = "2",
  "16400039" = "2",
  "16400003" = "2",
  "16400038" = "1",
  "16400074" = "5",
  "16400030" = "5",
  "20400292" = "5",
  "16400015" = "5",
  "16400005" = "5",
  "16400045" = "5",
  "16400061" = "4",
  "16400091" = "4",
  "20400281" = "4",
  "20400295" = "4",
  "16400026" = "4",
  "20400268" = "4",
  "16400040" = "3",
  "16400051" = "3",
  "16400052" = "3",
  "16400062" = "3",
  "16400027" = "3",
  "20400244" = "3",
  "20400290" = "2",
  "20400541" = "2",
  "16400098" = "2",
  "16400044" = "2",
  "16400078" = "2",
  "16400011" = "2",
  "16400042" = "2",
  "16400056" = "2",
  "16400073" = "2",
  "16400055" = "2",
  "16400063" = "2",
  "16400161" = "2",
  "16400100" = "2",
  "16400036" = "1"
)

zonetotier <- c(
  "16.1"  = "5",
  "16.2"  = "5",
  "16.3"  = "5",
  "16.4"  = "5",
  "16.5"  = "5",
  "16.6"  = "5",
  "16.7"  = "4",
  "16.8"  = "4",
  "16.9"  = "4",
  "16.10" = "4",
  "16.11" = "4",
  "16.12" = "4",
  "16.13" = "3",
  "16.14" = "3",
  "16.15" = "3",
  "16.16" = "3",
  "16.17" = "3",
  "16.18" = "3",
  "16.19" = "2",
  "16.20" = "2",
  "16.21" = "2",
  "16.22" = "2",
  "16.23" = "2",
  "16.24" = "2",
  "16.25" = "2",
  "16.26" = "2",
  "16.27" = "2",
  "16.28" = "2",
  "16.29" = "2",
  "16.30" = "2",
  "16.31" = "2",
  "16.32" = "1",
  "17.1"  = "5",
  "17.2"  = "5",
  "17.3"  = "5",
  "17.4"  = "5",
  "17.5"  = "5",
  "17.6"  = "5",
  "17.7"  = "4",
  "17.8"  = "4",
  "17.9"  = "4",
  "17.10" = "4",
  "17.11" = "4",
  "17.12" = "4",
  "17.13" = "3",
  "17.14" = "3",
  "17.15" = "3",
  "17.16" = "3",
  "17.17" = "3",
  "17.18" = "3",
  "17.19" = "2",
  "17.20" = "2",
  "17.21" = "2",
  "17.22" = "2",
  "17.23" = "2",
  "17.24" = "2",
  "17.25" = "2",
  "17.26" = "2",
  "17.27" = "2",
  "17.28" = "2",
  "17.29" = "2",
  "17.30" = "2",
  "17.31" = "2",
  "17.32" = "1",
  "18.1"  = "5",
  "18.2"  = "5",
  "18.3"  = "5",
  "18.4"  = "5",
  "18.5"  = "5",
  "18.6"  = "5",
  "18.7"  = "4",
  "18.8"  = "4",
  "18.9"  = "4",
  "18.10" = "4",
  "18.11" = "4",
  "18.12" = "4",
  "18.13" = "3",
  "18.14" = "3",
  "18.15" = "3",
  "18.16" = "3",
  "18.17" = "3",
  "18.18" = "3",
  "18.19" = "2",
  "18.20" = "2",
  "18.21" = "2",
  "18.22" = "2",
  "18.23" = "2",
  "18.24" = "2",
  "18.25" = "2",
  "18.26" = "2",
  "18.27" = "2",
  "18.28" = "2",
  "18.29" = "2",
  "18.30" = "2",
  "18.31" = "2",
  "18.32" = "1",
  "19.1"  = "5",
  "19.2"  = "5",
  "19.3"  = "5",
  "19.4"  = "5",
  "19.5"  = "5",
  "19.6"  = "5",
  "19.7"  = "4",
  "19.8"  = "4",
  "19.9"  = "4",
  "19.10" = "4",
  "19.11" = "4",
  "19.12" = "4",
  "19.13" = "3",
  "19.14" = "3",
  "19.15" = "3",
  "19.16" = "3",
  "19.17" = "3",
  "19.18" = "3",
  "19.19" = "2",
  "19.20" = "2",
  "19.21" = "2",
  "19.22" = "2",
  "19.23" = "2",
  "19.24" = "2",
  "19.25" = "2",
  "19.26" = "2",
  "19.27" = "2",
  "19.28" = "2",
  "19.29" = "2",
  "19.30" = "2",
  "19.31" = "2",
  "19.32" = "1",
  "20.1"  = "5",
  "20.2"  = "5",
  "20.3"  = "5",
  "20.4"  = "5",
  "20.5"  = "5",
  "20.6"  = "5",
  "20.7"  = "4",
  "20.8"  = "4",
  "20.9"  = "4",
  "20.10" = "4",
  "20.11" = "4",
  "20.12" = "4",
  "20.13" = "3",
  "20.14" = "3",
  "20.15" = "3",
  "20.16" = "3",
  "20.17" = "3",
  "20.18" = "3",
  "20.19" = "2",
  "20.20" = "2",
  "20.21" = "2",
  "20.22" = "2",
  "20.23" = "2",
  "20.24" = "2",
  "20.25" = "2",
  "20.26" = "2",
  "20.27" = "2",
  "20.28" = "2",
  "20.29" = "2",
  "20.30" = "2",
  "20.31" = "2",
  "20.32" = "1"
)

############## END mapping options ##################


glimpse(data)

# Data has the following shape at this point (auto-assigned column names:
# V1: "DD.MM.YYYY" date
# V2: "HH:MM:SS.SS" timestamp
# V3: Hexadecimal ID of the antenna that detected the tag
# V4: Decimal ID of the tag that was detected
# Note that it can be unordered
# Also note that the timestamps are not super-precise

#rename column names V3 to be HenID and V4 to be Antenna
head(data)
str(data)
names(data)[1] <- "Date"
names(data)[2] <- "Time"
names(data)[3] <- "Hen"
names(data)[4] <- "Antenna"
names(data)[5] <- "Coil"
sort(unique(data$Antenna))

############# ANTENNA wide format #############
# add antenna info
antenna.ID <- read_excel("//nas-vetsuisse/VETSUISSE/Benutzer/yg18q990/Project_Toepecking/Antennas_Position.xlsx")
head(antenna.ID)
str(antenna.ID)
antenna.ID$Pen <- as.factor(antenna.ID$Pen)
sort(unique(antenna.ID$Pen))
antenna.ID$Pophole <- as.character(antenna.ID$Pophole)
# change from wide to long format for antenna positions:
antenna.ID.long <- pivot_longer(antenna.ID, cols=c("left","middle", "right", "Pophole"), names_to="Antenna_Position", values_to="AntennaID")
antenna.ID.long <- antenna.ID.long %>% drop_na(AntennaID)
head(antenna.ID.long)
antenna.ID.long$AntennaID <- as.numeric(antenna.ID.long$AntennaID)
data.antenna <- merge(data,antenna.ID.long,by.x="Antenna",by.y ="AntennaID",all.x = T)
head(data.antenna)
sort(unique(data.antenna$side))
############ ANTENNA long format###############
antenna.ID <- read_excel("G:/VPHI/Welfare/2- Research Projects/Masha Marincek/Projects/Ca Timing/Antennas_Hobos/Antennas_Position.xlsx")
head(antenna.ID)
str(antenna.ID)
antenna.ID$Pen <- as.factor(antenna.ID$Pen)
sort(unique(antenna.ID$Pen))
antenna.ID$side <- as.factor(antenna.ID$side)
antenna.ID$left_right <- as.factor(antenna.ID$left_right)
antenna.ID$Position <- as.factor(antenna.ID$Position)

data.antenna <- merge(data,antenna.ID,by.x="Antenna",by.y ="Antenna_ID",all.x = T)
head(data.antenna)
sort(unique(data.antenna$side))
length(sort(unique(data.antenna$Hen)))
table(data.antenna$Pen,data.antenna$side)

# add Pen Info and link to BirdID
IDs <- read_excel("//nas-vetsuisse/VETSUISSE/Benutzer/yg18q990/Project_Toepecking/BirdID_Pen_ID.xlsx")
head(IDs)
names(IDs)[2] <- "Pen_Bird"

head(data.antenna)
dim(IDs)
dim(data.antenna)
dim(data.full)
head(IDs)

data.full <- merge(data.antenna,IDs,by.x="Hen",by.y ="Serial_N")
head(data.full)
sort(unique(data.full$side))

summary(data.full)

# Parse datetime with lubridate - understands fractional seconds
data.full[, clockTime := dmy_hms(paste(Date, Time))]

str(data.full)
sort(unique(data.full$clockTime))

# filter by time interval:
str(data.full)
data.full$clockTime <- format(as.POSIXct(data.full$clockTime),"%H:%M:%S")

table(data.antenna$Pen,data.antenna$side)
data.filtered <-data.full[data.full$clockTime >= "15:30:00" & data.full$clockTime <= "17:30:00",]
head(data.filtered,20)
sort(unique(data.full$Date))
sort(unique(data.full$side))


Pen15 <- subset(data.filtered, Pen=="15")
Pen15.filtered <-Pen15[Pen15$Date >= "18.11.2022" & Pen15$Date <= "19.11.2022",]

#write.csv(Pen15.filtered,"Pen15.filtered.csv", row.names = FALSE)
#View(Pen15.filtered)
table(Pen15.filtered$side,Pen15.filtered$Position)
#######
